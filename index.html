<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Shipping Instructions Êü•Ë©¢ - Pro</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
        <style>
            /* =========================================================================
            * 1. È°èËâ≤ËÆäÊï∏ËàáÊ∑±Ëâ≤Ê®°Âºè (Dark Mode)
            * ========================================================================= */
            :root {
                /* Light Mode Base Colors */
                --bg1: #f7f9fc;
                --bg2: #eef1f6;
                --card: #ffffff;
                --stroke: #e2e8f0;
                --text: #1e293b;
                --muted: #64748b;
                --accent: #3b82f6; /* Blue */
                --accent-glow: rgba(59, 130, 246, 0.4);
                --shadow: 0 4px 12px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.05);

                /* New Semantic Colors (Light Mode) */
                --model-color: #0c4a6e; /* Dark Cyan/Blue */
                --type-color-string: #059669; /* Emerald Green */
                --type-color-number: #ea580c; /* Orange */
                --type-color-boolean: #c026d3; /* Magenta */
                --type-color-array: #1d4ed8; /* Dark Blue */
                --type-color-object: #be123c; /* Red */
                --required-color: #3b82f6; /* Accent Blue */
                --enum-bg: #e0f2fe; /* Light Blue */
                --enum-text: #075985; /* Darker Blue */

                /* Dark Mode Toggle */
                --toggle-bg: #cbd5e1;
                --toggle-handle: #ffffff;
            }

            [data-theme="dark"] {
                /* Dark Mode Base Colors */
                --bg1: #0f172a;
                --bg2: #1e293b;
                --card: #2d3748;
                --stroke: #4a5568;
                --text: #f8fafc;
                --muted: #94a3b8;
                --accent: #60a5fa; /* Lighter Blue */
                --accent-glow: rgba(96, 165, 250, 0.4);
                --shadow: 0 4px 12px rgba(0, 0, 0, 0.4), 0 1px 3px rgba(0, 0, 0, 0.2);

                /* New Semantic Colors (Dark Mode) */
                --model-color: #90e0ef; /* Light Cyan */
                --type-color-string: #6ee7b7; /* Lighter Green */
                --type-color-number: #fdba74; /* Lighter Orange */
                --type-color-boolean: #f0abfc; /* Lighter Magenta */
                --type-color-array: #93c5fd; /* Lighter Dark Blue */
                --type-color-object: #f87171; /* Lighter Red */
                --required-color: #60a5fa; /* Accent Blue */
                --enum-bg: #1e3a8a; /* Dark Blue */
                --enum-text: #93c5fd; /* Light Blue */

                --toggle-bg: #4a5568;
                --toggle-handle: #1e293b;
            }

            /* =========================================================================
            * 2. Âü∫Êú¨Ê®£ÂºèËàáÊéíÁâà
            * ========================================================================= */
            * {
                box-sizing: border-box;
            }

            body {
                margin: 0;
                min-height: 100vh;
                color: var(--text);
                background-color: var(--bg1);
                background-image: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
                font-family: "Inter", "Noto Sans TC", system-ui, -apple-system, sans-serif;
                padding: 32px 16px 60px;
                transition: background-color 0.3s ease, color 0.3s ease;
            }

            .page {
                max-width: 1200px;
                margin: 0 auto;
                position: relative;
            }

            header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 24px;
            }

            .header-text {
                display: grid;
                gap: 8px;
            }

            h1 {
                margin: 0;
                font-size: 32px;
                letter-spacing: -0.02em;
                font-weight: 800;
            }
            .lead {
                margin: 0;
                color: var(--muted);
                font-size: 16px;
            }

            /* =========================================================================
            * 3. Dark Mode ÂàáÊèõÈñãÈóú
            * ========================================================================= */
            .dark-mode-toggle {
                cursor: pointer;
                width: 56px;
                height: 32px;
                background: var(--toggle-bg);
                border-radius: 16px;
                position: relative;
                transition: background 0.3s;
                margin-left: 16px;
                flex-shrink: 0;
                border: 1px solid var(--stroke);
            }

            .dark-mode-toggle::after {
                content: "";
                position: absolute;
                top: 3px;
                left: 3px;
                width: 24px;
                height: 24px;
                background: var(--toggle-handle);
                border-radius: 50%;
                transition: transform 0.3s ease, background 0.3s;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            }

            [data-theme="dark"] .dark-mode-toggle::after {
                transform: translateX(24px);
            }

            .toggle-wrapper {
                display: inline-flex;
                align-items: center;
                gap: 10px;
                color: var(--muted);
                font-size: 13px;
                font-weight: 600;
                white-space: nowrap;
            }

            /* =========================================================================
            * 4. Â∑•ÂÖ∑Ê¨ÑËàáÈÅéÊøæÂô® (Toolbar & Filters)
            * ========================================================================= */
            .toolbar {
                padding: 24px;
                background: var(--card);
                border-radius: 16px;
                box-shadow: var(--shadow);
                margin-bottom: 32px;
                border: 1px solid var(--stroke);
            }

            .filters {
                display: grid;
                gap: 16px;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                margin-bottom: 20px;
            }

            .field {
                display: grid;
                gap: 6px;
            }

            .field span {
                font-size: 11px;
                color: var(--muted);
                text-transform: uppercase;
                letter-spacing: 0.08em;
                font-weight: 600;
            }

            .field input {
                width: 100%;
                border: 1px solid var(--stroke);
                background: var(--bg1);
                color: var(--text);
                font-size: 15px;
                outline: none;
                padding: 10px 14px;
                border-radius: 10px;
                transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
            }

            .field input:focus {
                border-color: var(--accent);
                background: var(--card);
                box-shadow: 0 0 0 3px var(--accent-glow);
            }

            .actions {
                display: flex;
                flex-wrap: wrap;
                gap: 12px;
                align-items: center;
                margin-bottom: 20px;
            }

            .filter-summary {
                margin: 6px 0 12px;
                font-size: 13px;
                color: var(--accent);
                font-weight: 700;
            }

            .summary-chip {
                display: inline-flex;
                align-items: center;
                gap: 6px;
                padding: 4px 10px;
                border-radius: 999px;
                background: rgba(59, 130, 246, 0.12);
                color: var(--text);
                border: 1px solid rgba(59, 130, 246, 0.3);
                font-weight: 600;
            }

            /* =========================================================================
            * 5. ÊåâÈàï (Buttons)
            * ========================================================================= */
            button {
                border: 1px solid var(--stroke);
                background: var(--card);
                color: var(--text);
                border-radius: 10px;
                padding: 10px 18px;
                font-size: 14px;
                cursor: pointer;
                font-weight: 600;
                transition: transform 0.2s ease, background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            }

            button:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow);
            }

            button.primary {
                background: var(--accent);
                border: none;
                color: #ffffff;
                font-weight: 700;
                position: relative;
                overflow: hidden;
                box-shadow: 0 6px 18px var(--accent-glow);
            }

            /* Primary Button Glow Effect */
            button.primary::after {
                content: "";
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: rgba(255, 255, 255, 0.1);
                transform: rotate(45deg);
                transition: all 0.5s ease;
                opacity: 0;
            }

            button.primary:hover::after {
                left: 100%;
                opacity: 1;
            }

            /* =========================================================================
            * 6. ÂÖÉË≥áË®äËàáÂÇôË®ª (Meta & Note)
            * ========================================================================= */
            .meta {
                display: flex;
                flex-wrap: wrap;
                gap: 12px;
                align-items: center;
                color: var(--muted);
                font-size: 14px;
            }

            .pill {
                display: inline-flex;
                gap: 8px;
                align-items: center;
                padding: 8px 14px;
                border-radius: 999px;
                border: 1px solid var(--stroke);
                background: var(--bg2);
                color: var(--text);
                font-weight: 600;
                font-size: 13px;
            }

            .status-dot {
                width: 10px;
                height: 10px;
                border-radius: 50%;
                display: inline-block;
                background: var(--accent);
                transition: background 0.3s;
            }

            /* =========================================================================
            * 7. Ë°®Ê†ºÊ®£Âºè (Table)
            * ========================================================================= */
            table {
                width: 100%;
                border-collapse: separate;
                border-spacing: 0;
                background: var(--card);
                border: 1px solid var(--stroke);
                border-radius: 16px;
                overflow: hidden;
                box-shadow: var(--shadow);
            }

            thead {
                background: var(--bg2);
                transition: background 0.3s;
            }

            th,
            td {
                padding: 14px 18px;
                text-align: left;
                border-bottom: 1px solid var(--stroke);
                font-size: 14px;
                vertical-align: middle;
                transition: border-color 0.3s;
            }

            th {
                color: var(--text);
                font-weight: 700;
                white-space: nowrap;
            }

            tbody tr:last-child td {
                border-bottom: none;
            }

            tbody tr:hover {
                background: var(--bg2);
                transition: background 0.2s ease;
            }

            .muted {
                color: var(--muted);
            }

            /* Êñ∞Â¢ûÔºöÊ¨Ñ‰ΩçÂÄºÁöÑÊ®£ÂºèÂÆπÂô® */
            .field-value {
                font-weight: 600;
                color: var(--text);
            }

            /* =========================================================================
            * 8. Ê®ôÁ±§ËàáÂæΩÁ´† (Badges)
            * ========================================================================= */
            .badge {
                display: inline-flex;
                align-items: center;
                gap: 6px;
                padding: 5px 12px;
                border-radius: 999px;
                font-size: 12px;
                font-weight: 700;
                border: 1px solid transparent;
                white-space: nowrap;
            }

            .required {
                background: #dbeafe; /* Blue-50 */
                color: #1e40af; /* Blue-800 */
                border-color: #93c5fd; /* Blue-300 */
            }
            [data-theme="dark"] .required {
                background: rgba(59, 130, 246, 0.2);
                color: #93c5fd;
                border-color: rgba(59, 130, 246, 0.4);
            }

            .optional {
                background: #f3f4f6; /* Gray-100 */
                color: #4b5563; /* Gray-700 */
                border-color: #e5e7eb; /* Gray-200 */
            }
            [data-theme="dark"] .optional {
                background: rgba(148, 163, 184, 0.2);
                color: #cbd5e1;
                border-color: rgba(148, 163, 184, 0.4);
            }

            .model-chip {
                display: inline-flex;
                align-items: center;
                padding: 4px 10px;
                border-radius: 10px;
                background: rgba(79, 156, 249, 0.12);
                color: var(--model-color); /* ‰ΩøÁî®Êñ∞ÁöÑ Model È°èËâ≤ */
                border: 1px solid rgba(79, 156, 249, 0.3);
                font-weight: 700;
                font-size: 12px;
                white-space: nowrap;
            }

            /* =========================================================================
            * 9. Á®ãÂºèÁ¢ºËàáÂàóËàâÂÄº (Code & Enum)
            * ========================================================================= */
            .enum-list {
                display: flex;
                flex-wrap: wrap;
                gap: 6px;
                max-width: 300px;
            }

            .enum-item {
                padding: 4px 10px;
                border-radius: 8px;
                background: var(--enum-bg); /* ‰ΩøÁî®Êñ∞ÁöÑ Enum ËÉåÊôØËâ≤ */
                color: var(--enum-text); /* ‰ΩøÁî®Êñ∞ÁöÑ Enum ÊñáÂ≠óËâ≤ */
                border: 1px solid var(--stroke);
                font-size: 11px;
                font-weight: 600;
                white-space: nowrap;
            }

            code {
                background: var(--bg2);
                padding: 3px 8px;
                border-radius: 6px;
                font-family: monospace;
                font-size: 13px;
                color: var(--text);
                border: 1px solid var(--stroke); /* Á®ãÂºèÁ¢ºÂ°äÂ¢ûÂä†ÈÇäÊ°Ü */
            }

            .nowrap {
                white-space: nowrap;
            }

            /* Êñ∞Â¢ûÔºö‰æù Type ÂçÄÂàÜÊñáÂ≠óÈ°èËâ≤ */
            .field-type-string {
                color: var(--type-color-string);
                font-weight: 700;
            }
            .field-type-number,
            .field-type-integer {
                color: var(--type-color-number);
                font-weight: 700;
            }
            .field-type-boolean {
                color: var(--type-color-boolean);
                font-weight: 700;
            }
            .field-type-array {
                color: var(--type-color-array);
                font-weight: 700;
            }
            .field-type-object {
                color: var(--type-color-object);
                font-weight: 700;
            }

            /* Êñ∞Â¢ûÔºöDescription/‰∏≠ÊñáË™™Êòé ÁöÑÊñáÂ≠óÈ°èËâ≤ËàáÊ®£Âºè */
            .field-description {
                font-weight: 500;
            }
            .field-zh-description {
                color: var(--muted);
                font-size: 13px;
            }

            /* =========================================================================
            * 10. RWD ÈÅ©ÊáâÊÄß (Media Queries)
            * ========================================================================= */
            @media (max-width: 1024px) {
                h1 {
                    font-size: 28px;
                }
                .toolbar {
                    padding: 20px;
                }
                .filters {
                    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                }
                th,
                td {
                    padding: 12px 14px;
                    font-size: 13px;
                }
            }

            @media (max-width: 768px) {
                body {
                    padding: 16px 12px 32px;
                }
                header {
                    flex-direction: column;
                    align-items: stretch;
                }
                .dark-mode-toggle {
                    margin-top: 10px;
                }
                .toolbar {
                    margin-bottom: 24px;
                }
                table {
                    display: block;
                    overflow-x: auto;
                    border-radius: 12px;
                    width: 100%;
                    white-space: nowrap;
                }
                th,
                td {
                    min-width: 120px;
                }
            }
        </style>
    </head>
    <body data-theme="light">
        <div class="page">
            <header>
                <div class="header-text">
                    <h1>üì¶ Shipping Instructions Ê¨Ñ‰ΩçÊü•Ë©¢</h1>
                </div>
                <div class="toggle-wrapper" aria-label="ÂàáÊèõÊ®°Âºè">
                    <span aria-hidden="true">‚òÄÔ∏è</span>
                    <div id="dark-mode-toggle" class="dark-mode-toggle" title="ÂàáÊèõÊ∑±Ëâ≤/Ê∑∫Ëâ≤Ê®°Âºè"></div>
                    <span aria-hidden="true">‚ö´</span>
                </div>
            </header>

            <div class="toolbar">
                <div class="filters">
                    <label class="field">
                        <span>Field</span>
                        <input id="filter-field" type="search" placeholder="HSCodes" autocomplete="off" />
                    </label>
                    <label class="field">
                        <span>Type</span>
                        <input id="filter-type" type="search" placeholder="string / boolean / array" autocomplete="off" />
                    </label>
                    <!-- <label class="field">
                        <span>Description (Âê´‰∏≠Êñá)</span>
                        <input id="filter-description" type="search" placeholder="Ëº∏ÂÖ•Ëã±ÊñáÊàñ‰∏≠ÊñáÈóúÈçµÂ≠ó" autocomplete="off" />
                    </label> -->
                    <label class="field">
                        <span>Required</span>
                        <input id="filter-required" type="search" placeholder="true / false / ÂøÖÂ°´ / ÈÅ∏Â°´" autocomplete="off" />
                    </label>
                    <label class="field">
                        <span>Enum</span>
                        <input id="filter-enum" type="search" placeholder="PRE / COL" autocomplete="off" />
                    </label>
                    <!-- <label class="field">
                        <span>Example</span>
                        <input id="filter-example" type="search" placeholder="SWB / e0559d83..." autocomplete="off" />
                    </label> -->
                </div>
                <div class="actions">
                    <button id="search-button" class="primary" type="button">üöÄ Á´ãÂç≥Êü•Ë©¢</button>
                    <button id="reset-button" type="button">Ê∏ÖÈô§Ê¢ù‰ª∂</button>
                </div>
                <div class="meta">
                    <span class="pill"><span class="status-dot"></span><span id="match-count">Â∞öÊú™Êü•Ë©¢</span></span>
                </div>
                <div class="filter-summary" id="filter-summary">ÁõÆÂâçÊ¢ù‰ª∂ÔºöÁÑ°„ÄÇ</div>
            </div>

            <table aria-label="Shipping instruction fields">
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Field</th>
                        <th>Type</th>
                        <!-- <th>Description</th>
                        <th>‰∏≠ÊñáË™™Êòé</th> -->
                        <th>Required</th>
                        <!-- <th>Example</th> -->
                        <th>Enum</th>
                    </tr>
                </thead>
                <tbody id="results"></tbody>
            </table>
        </div>

        <script>
            // =========================================================================
            // 1. Dark Mode ÈÇèËºØ (‰øùÁïô)
            // =========================================================================
            const body = document.body;
            const toggle = document.getElementById("dark-mode-toggle");

            // Ê™¢Êü• localStorage ÊàñÁ≥ªÁµ±ÂÅèÂ•ΩË®≠ÂÆö
            const getInitialTheme = () => {
                const storedTheme = localStorage.getItem("theme");
                if (storedTheme) {
                    return storedTheme;
                }
                return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
            };

            const applyTheme = (theme) => {
                body.setAttribute("data-theme", theme);
                localStorage.setItem("theme", theme);
            };

            toggle.addEventListener("click", () => {
                const currentTheme = body.getAttribute("data-theme");
                const newTheme = currentTheme === "light" ? "dark" : "light";
                applyTheme(newTheme);
            });

            // ÂàùÂßãÂåñ‰∏ªÈ°å
            applyTheme(getInitialTheme());

            // =========================================================================
            // 2. ÂéüÂßãÊü•Ë©¢ËàáÊ∏≤ÊüìÈÇèËºØ (Ë™øÊï¥Ê∏≤ÊüìÈÉ®ÂàÜ)
            // =========================================================================
            const resultsBody = document.getElementById("results");
            const matchCount = document.getElementById("match-count");
            const filterSummary = document.getElementById("filter-summary");
            let fieldData = [];
            let dataLoaded = false;
            let loading = false;

            const filters = {
                field: document.getElementById("filter-field"),
                type: document.getElementById("filter-type"),
                // description: document.getElementById("filter-description"),
                required: document.getElementById("filter-required"),
                // example: document.getElementById("filter-example"),
                enum: document.getElementById("filter-enum"),
            };

            // ÁøªË≠ØÂ≠óÂÖ∏ (‰øùÁïô)
            const dict = [
                ["shipping instructions", "ÊèêÂñÆË≥áÊñô"],
                ["transport document", "ÈÅãËº∏Êñá‰ª∂"],
                ["bill of lading", "ÊèêÂñÆ"],
                ["sea waybill", "Êµ∑ÈÅãÊèêÂñÆ"],
                ["identifier", "Ë≠òÂà•Á¢º"],
                ["reference", "ÂèÉËÄÉÁ¢º"],
                ["code", "‰ª£Á¢º"],
                ["description", "Ë™™Êòé"],
                ["required", "ÂøÖÂ°´"],
                ["optional", "ÈÅ∏Â°´"],
                ["string", "ÊñáÂ≠ó"],
                ["integer", "Êï¥Êï∏"],
                ["number", "Êï∏ÂÄº"],
                ["boolean", "Â∏ÉÊûó"],
                ["array", "Èô£Âàó"],
                ["object", "Áâ©‰ª∂"],
                ["carrier", "ËàπÂÖ¨Âè∏"],
                ["location", "Âú∞Èªû"],
                ["country", "ÂúãÂÆ∂"],
                ["city", "ÂüéÂ∏Ç"],
                ["address", "Âú∞ÂùÄ"],
                ["email", "ÈõªÂ≠êÈÉµ‰ª∂"],
                ["phone", "ÈõªË©±"],
                ["date", "Êó•Êúü"],
                ["time", "ÊôÇÈñì"],
                ["status", "ÁãÄÊÖã"],
                ["approval", "Ê†∏ÂáÜ"],
                ["party", "Áõ∏ÈóúÊñπ"],
                ["contact", "ËÅØÁµ°‰∫∫"],
                ["vessel", "ËàπÂêç"],
                ["voyage", "Ëà™Ê¨°"],
                ["name", "ÂêçÁ®±"],
                ["cargo", "Ë≤®Áâ©"],
                ["container", "Ë≤®Ê´É"],
                ["quantity", "Êï∏Èáè"],
                ["weight", "ÈáçÈáè"],
                ["volume", "È´îÁ©ç"],
            ];

            const translateToZh = (text = "") => {
                // ÈÄôË£°ÊáâË©≤ÊòØÂØ¶ÈöõÁöÑÁøªË≠ØÈÇèËºØÔºå‰ΩÜÁî±ÊñºÁÑ°Ê≥ïÂ≠òÂèñÂ§ñÈÉ®Ë≥áÊ∫êÔºåÊö´ÊôÇ‰øùÊåÅÂéüÊ®£ÊàñÁ∞°ÂñÆËôïÁêÜ
                return text && text.trim() ? text : "(no description)";
            };

            const escapeHtml = (str = "") => str.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#39;");

            const formatEnum = (values) => {
                if (!Array.isArray(values) || values.length === 0) return '<span class="muted">-</span>';
                return `<span class="enum-list">${values.map((v) => `<span class="enum-item">${escapeHtml(String(v))}</span>`).join("")}</span>`;
            };

            const renderRows = (rows) => {
                resultsBody.innerHTML = rows
                    .map((item) => {
                        const zh = translateToZh(item.description || "");
                        const exampleHtml = item.example !== null && item.example !== undefined ? `<code>${escapeHtml(String(item.example))}</code>` : '<span class="muted">-</span>';
                        const requiredBadge = item.required ? '<span class="badge required">ÂøÖÂ°´</span>' : '<span class="badge optional">ÈÅ∏Â°´</span>';

                        // ÈáùÂ∞ç Type Ê¨Ñ‰ΩçÔºåÂ¢ûÂä†ÂãïÊÖãÈ°ûÂà•
                        const typeClass = item.type ? `field-type-${String(item.type).toLowerCase()}` : "muted";
                        return `
                        <tr>
                            <td class="nowrap">${item.model ? `<span class="model-chip field-model">${escapeHtml(item.model)}</span>` : '<span class="muted">-</span>'}</td>
                            <td class="nowrap"><span class="field-value">${escapeHtml(item.field || "")}</span></td>
                            <td class="nowrap"><span class="field-value ${typeClass}">${escapeHtml(item.type || "")}</span></td>
                            <td class="nowrap field-required">${requiredBadge}</td>
                            <td>${formatEnum(item.enum)}</td>
                        </tr>
                    `;
                        //     return `
                        //     <tr>
                        //         <td class="nowrap">${item.model ? `<span class="model-chip field-model">${escapeHtml(item.model)}</span>` : '<span class="muted">-</span>'}</td>
                        //         <td class="nowrap"><span class="field-value">${escapeHtml(item.field || "")}</span></td>
                        //         <td class="nowrap"><span class="field-value ${typeClass}">${escapeHtml(item.type || "")}</span></td>
                        //         <td><span class="field-value field-description">${escapeHtml(item.description || "")}</span></td>
                        //         <td><span class="field-value field-zh-description">${zh}</span></td>
                        //         <td class="nowrap field-required">${requiredBadge}</td>
                        //         <td>${exampleHtml}</td>
                        //         <td>${formatEnum(item.enum)}</td>
                        //     </tr>
                        // `;
                    })
                    .join("");
                matchCount.textContent = `${rows.length} Á≠ÜÁ¨¶ÂêàÊ¢ù‰ª∂`;
            };

            const fuzzyIncludes = (value, term) => (value ?? "").toString().toLowerCase().includes(term.toLowerCase());
            const requiredLabel = (val) => (val ? "true required yes ÂøÖÂ°´ ÈúÄË¶Å" : "false optional no ÈÅ∏Â°´ ‰∏çÈúÄË¶Å");

            const filterRows = (terms) =>
                fieldData.filter((item) => {
                    const itemDescription = item.description || "";
                    const itemZhDescription = translateToZh(itemDescription);
                    const itemEnum = (item.enum || []).join(", ");

                    return (
                        (!terms.field || fuzzyIncludes(item.field, terms.field)) &&
                        (!terms.type || fuzzyIncludes(item.type, terms.type)) &&
                        // (!terms.description || fuzzyIncludes(itemDescription, terms.description) || fuzzyIncludes(itemZhDescription, terms.description)) &&
                        (!terms.required || fuzzyIncludes(requiredLabel(item.required), terms.required)) &&
                        // (!terms.example || fuzzyIncludes(item.example, terms.example)) &&
                        (!terms.enum || fuzzyIncludes(itemEnum, terms.enum))
                    );
                });

            const formatSummary = (terms) => {
                const labels = {
                    field: "Field",
                    type: "Type",
                    // description: "Description",
                    required: "Required",
                    // example: "Example",
                    enum: "Enum",
                };
                const chips = [];
                for (const [key, label] of Object.entries(labels)) {
                    const val = terms[key];
                    if (val) {
                        chips.push(`<span class="summary-chip"><strong>${label}:</strong> ${escapeHtml(val)}</span>`);
                    }
                }
                return chips.length ? `Current filters: ${chips.join(" ")}` : "Current filters: none.";
            };

            const renderPlaceholder = (message) => {
                resultsBody.innerHTML = `<tr><td colspan="8" class="muted" style="text-align: center; padding: 30px;">${escapeHtml(message)}</td></tr>`;
            };

            const ensureData = async () => {
                if (dataLoaded || loading) return;
                loading = true;
                matchCount.textContent = "ËºâÂÖ•Ë≥áÊñô‰∏≠...";
                try {
                    // Ê®°Êì¨ËºâÂÖ•Ë≥áÊñôÔºåÊÇ®ÈúÄË¶ÅÁ¢∫‰øù parsed_fields_filtered.json Â≠òÂú®ÊñºÊ≠£Á¢∫ÁöÑË∑ØÂæë
                    const url = new URL("parsed_fields_filtered.json", window.location.href);
                    const res = await fetch(url);
                    if (!res.ok) throw new Error(`HTTP ${res.status}`);
                    fieldData = await res.json();
                    dataLoaded = true;
                    matchCount.textContent = "Ë≥áÊñôÂ∑≤ËºâÂÖ•ÔºåË´ãËº∏ÂÖ•Ê¢ù‰ª∂";
                } catch (err) {
                    resultsBody.innerHTML = `<tr><td colspan="8" style="text-align: center; color: var(--type-color-object);">ÁÑ°Ê≥ïËÆÄÂèñ parsed_fields_filtered.jsonÔºö${escapeHtml(
                        err.message
                    )}„ÄÇË´ãÊ™¢Êü•Ê™îÊ°àË∑ØÂæë„ÄÇ</td></tr>`;
                    matchCount.textContent = "ËÆÄÂèñÊ™îÊ°àÂ§±Êïó";
                    console.error(err);
                } finally {
                    loading = false;
                }
            };

            const collectTerms = () => ({
                field: filters.field.value.trim(),
                type: filters.type.value.trim(),
                // description: filters.description.value.trim(),
                required: filters.required.value.trim(),
                // example: filters.example.value.trim(),
                enum: filters.enum.value.trim(),
            });

            const applyFilters = async () => {
                const terms = collectTerms();
                const hasInput = Object.values(terms).some((v) => v);

                await ensureData();
                if (!dataLoaded) return;

                if (!hasInput) {
                    renderPlaceholder("Enter keywords to search (data successfully loaded).");
                    matchCount.textContent = "No query yet";
                    filterSummary.innerHTML = "Current filters: none.";
                    return;
                }

                const rows = filterRows(terms);
                filterSummary.innerHTML = formatSummary(terms);
                if (rows.length === 0) {
                    renderPlaceholder("No data found. Try adjusting keywords.");
                    matchCount.textContent = "0 matches";
                    return;
                }
                renderRows(rows);
            };

            const resetFilters = () => {
                Object.values(filters).forEach((input) => {
                    input.value = "";
                });
                matchCount.textContent = "No query yet";
                renderPlaceholder("Cleared. Please enter keywords to search.");
                filterSummary.innerHTML = "Current filters: none.";
            };

            // ‰∫ã‰ª∂Áõ£ËÅΩ
            Object.values(filters).forEach((input) => input.addEventListener("input", applyFilters));

            document.getElementById("search-button").addEventListener("click", applyFilters);
            document.getElementById("reset-button").addEventListener("click", resetFilters);

            // ÂàùÂßãÊèêÁ§∫
            renderPlaceholder("Enter keywords to search (data loads on first search).");
        </script>
    </body>
</html>
